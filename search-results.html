<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Search Results | Blue Ember Store</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="universal.css" rel="stylesheet">
  <link href="home.css" rel="stylesheet">
  <link href="darkmode.css" rel="stylesheet">
  <link href="navbar.css" rel="stylesheet">
  <link href="mobile-sidebar.css" rel="stylesheet">
  <link rel="stylesheet" href="product.css">
  <link href="chatbot.css" rel="stylesheet">
  <script src="js/chatbot.js" defer></script>
  <script src="https://unpkg.com/finisher-header@1.0.0/dist/finisher-header.es5.min.js"></script>
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <link href="RESPONSIVENESS.css" rel="stylesheet">
  <link href='https://cdn.boxicons.com/3.0.6/fonts/basic/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="css/cookie-consent.css">
  <link rel="stylesheet" href="footer.css">

  <script src="js/cart.js" defer></script>
  <script src="js/order-manager.js" defer></script>
  <script src="js/cart-manager.js" defer></script>
  <script src="js/scroll-reveal.js" defer></script>
  <script src="js/auth.js"></script>
  <style>
    img {
      display: block;
    }
#wishlist-toggle{
      position: static !important;
    }
    :root {
      --primary: #1fa6d6;
      --success: #28a745;
      --border: #dee2e6;
      --light-bg: #f8f9fa;
      --text-muted: #6c757d;
      --gap: 8px;
      --card-radius: 6px;
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.1);
      --transition: all 0.2s ease;
    }

    /* Base Styles */
    .search-container {
      padding: 1rem 0;
    }

    .search-bar-container {
      margin-bottom: 1rem;
    }

    .search-bar-container input {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }

    /* --- Premium Filters Section Revamp --- */
    .filters-section {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 25px 12px;
      border-radius: 24px;
      margin-bottom: 2rem;
      border: 1px solid rgba(0, 153, 255, 0.1);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }

    body.dark-mode .filters-section {
      background: rgba(30, 41, 59, 0.85);
      border-color: rgba(255, 255, 255, 0.1);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .filter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .filter-header h4 {
      margin: 0;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--primary);
    }

    .filter-close {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #f1f5f9;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #64748b;
      transition: all 0.2s;
      cursor: pointer;
    }

    body.dark-mode .filter-close {
      background: #334155;
      color: #94a3b8;
    }

    .filter-close:hover {
      background: #e11d48;
      color: white;
      transform: rotate(90deg);
    }

    .filter-group {
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }

    body.dark-mode .filter-group {
      border-bottom-color: rgba(255, 255, 255, 0.05);
    }

    .filter-group h5 {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: #1e293b;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    body.dark-mode .filter-group h5 {
      color: #f1f5f9;
    }

    /* Custom Select Styling */
    .form-select#sort-select,
    .form-select#mobile-sort-select {
      border-radius: 12px;
      padding: 0.6rem 1rem;
      border: 1px solid #e2e8f0;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    body.dark-mode .form-select {
      background-color: #0f172a;
      border-color: #334155;
      color: #f1f5f9;
    }

    .form-select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(31, 166, 214, 0.1);
    }

    /* Uiverse-inspired Brand Checkboxes */
    .brand-checkbox {
      position: relative;
      display: flex;
      align-items: center;
      margin-bottom: 0.75rem;
      cursor: pointer;
      user-select: none;
    }

    .brand-checkbox input {
      display: none;
    }

    .brand-checkbox label {
      position: relative;
      padding-left: 32px;
      cursor: pointer;
      font-size: 0.9rem;
      color: #475569;
      transition: all 0.2s;
      width: 100%;
    }

    body.dark-mode .brand-checkbox label {
      color: #94a3b8;
    }

    .brand-checkbox label::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      border: 2px solid #cbd5e1;
      border-radius: 6px;
      background: white;
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    body.dark-mode .brand-checkbox label::before {
      background: #1e293b;
      border-color: #475569;
    }

    .brand-checkbox input:checked+label::before {
      background: var(--primary);
      border-color: var(--primary);
      transform: translateY(-50%) scale(1.1);
    }

    .brand-checkbox label::after {
      content: '\f00c';
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      position: absolute;
      left: 4px;
      top: 50%;
      transform: translateY(-50%) scale(0);
      color: white;
      font-size: 0.7rem;
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .brand-checkbox input:checked+label::after {
      transform: translateY(-50%) scale(1);
    }

    .brand-checkbox:hover label {
      color: var(--primary);
    }

    /* Premium Range Slider */
    .price-range-values {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1.2rem;
      font-family: 'Inter', sans-serif;
    }

    .price-range-values span {
      background: rgba(31, 166, 214, 0.1);
      color: var(--primary);
      padding: 3px;
      border-radius: 8px;
      font-weight: 700;
      font-size: 0.9rem;
    }

    .price-range-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 6px;
      background: #e2e8f0;
      border-radius: 15px;
      outline: none;
      margin: 0.5rem 0;
    }

    body.dark-mode .price-range-slider {
      background: #334155;
    }

    .price-range-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--primary);
      cursor: pointer;
      border: 3px solid white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s;
    }

    input {
      padding: 10px 0;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-family: inherit;
      font-size: 16px;
      transition: border-color 0.3s;
    }

    .price-range-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
    }

    /* Clear Filters Button */
    #clear-filters {
      padding: 0.8rem;
      border-radius: 15px;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      font-size: 0.8rem;
      border: 1px solid #cbd5e1;
      background: transparent;
      color: #64748b;
      transition: all 0.3s;
    }

    #clear-filters:hover {
      background: #f1f5f9;
      color: #0f172a;
      border-color: #94a3b8;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    body.dark-mode #clear-filters {
      border-color: #334155;
      color: #94a3b8;
    }

    body.dark-mode #clear-filters:hover {
      background: #334155;
      color: white;
    }

    /* Mobile Filters Button */
    .mobile-filters-btn {
      display: none;
      background: white;
      border: 1px solid #e2e8f0;
      padding: 0.7rem 1.2rem;
      border-radius: 12px;
      font-weight: 600;
      color: #1e293b;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
      margin-bottom: 1.5rem;
      width: 100%;
      transition: all 0.2s;
    }

    body.dark-mode .mobile-filters-btn {
      background: #1e293b;
      border-color: #334155;
      color: #f1f5f9;
    }

    .mobile-filters-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.05);
    }

    /* Premium Scrollbar for Filters Section */
    .filters-section::-webkit-scrollbar {
      width: 5px;
    }

    .filters-section::-webkit-scrollbar-track {
      background: transparent;
    }

    .filters-section::-webkit-scrollbar-thumb {
      background: rgba(0, 153, 255, 0.2);
      border-radius: 10px;
    }

    .filters-section::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
    }


    /* Results Grid - Responsive Masonry Layout */
    #results-container {
      display: block !important;
      column-gap: 8px;
      margin: 0;
      width: 100%;
      min-height: 400px;
    }

    /* Column counts for Masonry based on user requirements */
    @media (min-width: 1280px) {
      #results-container {
        column-count: 4 !important;
      }
    }

    @media (min-width: 898px) and (max-width: 1279px) {
      #results-container {
        column-count: 3 !important;
      }
    }

    @media (max-width: 897px) {
      #results-container {
        column-count: 2 !important;
      }
    }

    @media (max-width: 480px) {
      #results-container {
        column-count: 1 !important;
        /* Single column only on very small screens if needed, but keeping 2 is better for masonry */
        column-count: 2 !important;
        column-gap: 10px;
      }
    }

    .product-card {
      break-inside: avoid;
      -webkit-column-break-inside: avoid;
      display: inline-block !important;
      /* Critical for Masonry */
      width: 100%;
      background: white;
      border: 1px solid var(--border);
      border-radius: 16px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      position: relative;
    }

    body.dark-mode .product-card {
      background: #1e293b;
      border-color: #334155;
    }

    .product-card:hover {
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }

    .product-img-container {
      width: 100%;
      height: 180px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff;
      padding: 1rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.03);
    }

    body.dark-mode .product-img-container {
      background: white;
      /* Keep product background white for clarity or adjust to #2d3748 */
    }

    .product-img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .product-info {
      padding: 1.2rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .product-title {
      font-weight: 700;
      font-size: 0.95rem;
      color: #1e293b;
      line-height: 1.4;
      margin: 0;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      overflow: hidden;
    }

    body.dark-mode .product-title {
      color: #f1f5f9;
    }

    .product-desc {
      font-size: 0.8rem;
      color: #64748b;
      line-height: 1.5;
      margin: 0;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      overflow: hidden;
    }

    body.dark-mode .product-desc {
      color: #94a3b8;
    }

    .product-price {
      font-size: 1.1rem;
      font-weight: 800;
      color: var(--primary);
      margin: 0.2rem 0;
    }

    .add-to-cart {
      width: 100%;
      padding: 0.6rem;
      font-size: 0.85rem;
      font-weight: 600;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .add-to-cart:hover {
      background: #1a8fc4;
    }

    .add-to-cart.added {
      background: #10b981 !important;
    }

    .highlight {
      background-color: #fff3cd;
      font-weight: bold;
      padding: 0 2px;
      border-radius: 4px;
      color: black;
    }

    .no-results {
      text-align: center;
      padding: 2rem;
      color: var(--text-muted);
      grid-column: 1 / -1;
      background: white;
      border-radius: var(--card-radius);
      box-shadow: var(--shadow-sm);
    }

    .no-results i {
      font-size: 2.5rem;
      margin-bottom: 0.75rem;
      color: #e9ecef;
    }

    /* --- Responsive Behavior for Filters --- */
    @media (max-width: 768px) {
      .filters-section {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: min(85vh, 650px);
        z-index: 10001;
        margin-bottom: 0;
        border-radius: 30px 30px 0 0;
        background: white;
        transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        display: block;
        overflow-y: auto;
        box-shadow: 0 -20px 50px rgba(0, 0, 0, 0.15);
        padding: 3.5rem 1.5rem 2rem 1.5rem;
        transform: translateY(100%);
        visibility: hidden;
      }

      .filters-section.show {
        transform: translateY(0);
        visibility: visible;
      }

      .mobile-filters-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .filter-close {
        display: flex;
        position: absolute;
        top: 15px;
        right: 20px;
        z-index: 10;
      }

      /* Backdrop for mobile filters */
      .filters-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(4px);
        z-index: 9998;
        display: none;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .filters-backdrop.show {
        display: block;
        opacity: 1;
      }

      /* Results container adjustments */
      #results-container {
        grid-template-columns: 1fr;
      }
    }

    @media (min-width: 769px) {
      .filters-section {
        display: block;
        overflow-y: visible;
        top: 90px;
        position: sticky;
        zoom: 84%;
      }

      .filter-close {
        display: none;
      }

      .search-results-page-layout {
        display: flex;
        gap: 2rem;
      }
    }




    /* Social Icons - Externalized from inline styles */
    .social-facebook {
      color: rgb(0, 119, 255) !important;
    }

    .social-instagram {
      color: rgb(255, 0, 200) !important;
    }

    .social-twitter {
      color: rgb(29, 161, 242) !important;
    }

    .social-youtube {
      color: rgb(255, 0, 0) !important;
    }

    .contact-phone {
      color: rgb(0, 89, 255) !important;
    }

    .contact-envelope {
      color: rgb(0, 89, 255) !important;
    }

    /* --- Animated Search Bar Styles --- */
    /* Define the Angle Property for smooth rotation */
    @property --angle {
      syntax: '<angle>';
      initial-value: 0deg;
      inherits: false;
    }

    /* The Animated RGB Border & Glow */
    .search-container::before,
    .search-container::after {
      content: '';
      position: absolute;
      /* Negative inset controls border thickness */
      inset: -3px;
      border-radius: 50px;
      z-index: -1;
      /* YOUR SPECIFIC COLORS */
      background: conic-gradient(from var(--angle), #0099ff, #0099ff, #01e8bc, #01e8bc, #0099ff);
      /* Start Hidden */
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    /* Special Blur for the Shadow (::after) */
    .search-container::after {
      filter: blur(25px);
      z-index: -2;
    }

    /* Animation Triggers (Hover AND Click/Focus) */
    /* When Hovering OR When Input is Focused (Clicked) */
    .search-container:hover::before,
    .search-container:hover::after,
    .search-container:focus-within::before,
    .search-container:focus-within::after {
      opacity: 1;
      animation: spin-clockwise 10s linear infinite;
    }

    /* The Input Field */
    .search-input {
      height: 100%;
      border: none;
      outline: none;
      position: relative;
      z-index: 501;
      background: #ffffff;
      border-radius: 50px;
      margin: 0px -30px 0px 0px;
      padding: 0 15px 0 15px;
      font-size: 18px;
      color: #000000;
      box-shadow: inset 0 0 0 1px #000000;
      transition: box-shadow 0.3s ease;


    }

    .search-input::placeholder {
      color: #008080;
      /* Teal Placeholder */
      opacity: 0.7;
    }

    /* Hide the static Teal border when the animated border is active */
    .search-container:hover .search-input,
    .search-container:focus-within .search-input {
      box-shadow: inset 0 0 0 0 transparent;
    }

    /* Search Icon */
    .search-button {
      position: relative;
      right: -6px;
      width: 103px;
      height: 65px;
      pointer-events: auto;
      background: #0099ff;
      border: none;
      padding: 16px 19px 15px 40px;
    }

    .search-button i {
      fill: #008080;
      margin: 16px;
      padding: 11px 22px 11px 22px;
      align-self: center;
      border-radius: 25px;
      display: table;
      background: #ffffff8a;
      transition: color 0.3s ease;
    }

    /* Make icon black when typing */
    .search-container:focus-within .search-button i {
      color: #000000;
    }

    /* The Animation Keyframes */
    @keyframes spin-clockwise {
      0% {
        --angle: 0deg;
      }

      100% {
        --angle: 360deg;
      }
    }

    /* Override existing search-container styles */
    .search-container {
      position: relative;
      width: 400px;
      min-width: 200px;
      height: 50px;
      border-radius: 50px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1;
      padding: 0;
      /* Remove existing padding */
    }

    .search-container form {
      width: 100%;
      height: 100%;
      position: relative;
    }

    /* Navbar Logo Animation - Similar to payment-icon pattern */
    .navbar-logo img {
      transition: all 0.3s ease;
      mix-blend-mode: normal;
    }

    /* Apply GIF effects on hover - similar to payment-icon hover behavior */
    .navbar-logo:hover img {
      mix-blend-mode: multiply;
      transform: scale(1.1);
      filter: brightness(1.2);
    }

    /* Payment Icon - Applied to checkout button */
    .payment-icon {
      display: inline-block;
      width: 30px;
      height: 30px;
      margin-right: 10px;
      margin-bottom: 8px;
      vertical-align: middle;
      background: url('assets/tap-to-pay.png') no-repeat center/contain;
      transition: opacity 0.3s ease;
    }

    /* Hide icon when button is disabled */
    .checkout-btn:disabled .payment-icon {
      opacity: 0.7;
    }

    /* Show GIF ONLY on enabled buttons during hover */
    .checkout-btn:not(:disabled):hover .payment-icon {
      background-image: url('assets/tap-to-pay.gif');
      mix-blend-mode: multiply;
      scale: 1.7;
    }

    @media (max-width: 480px) {
      .navbar-logo {
        width: 57px !important;
        height: 5px !important;
        scale: 0.6 !important;
      }

      .search-container {
        height: 44px !important;
        width: 220px;
        display: none;
      }

      .search-input {
        padding: 0 15px 0 10px !important;
      }
    }

    /* Enhanced Split Button & Dropdown Theme */
    .split-button {
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .split-button.single-toggle-action:before {
      transform: scaleX(1.015) scaleY(1.035) perspective(1px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
      transition: transform .2s cubic-bezier(.345, .115, .135, 1.42), opacity .15s ease-out;
    }

    .split-button:hover {
      box-shadow: 0 8px 15px rgba(0, 153, 255, 0.15) !important;
      border-color: rgba(0, 153, 255, 0.3);
      transform: translateY(-1px);
    }

    .split-button:hover .split-button-content {
      color: #0064e7 !important;
    }

    .split-button:hover .split-button-content i {
      color: #0099ff !important;
    }

    .split-button-right {
      border-left: 1px solid rgba(0, 0, 0, 0.06);
      position: relative;
      overflow: hidden;
      color: #1e293b;
    }

    .split-button-right::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, #0099ff, #00c11b);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 0;
    }

    .split-button-right:hover::before {
      opacity: 0.1;
    }

    .split-button-right i {
      z-index: 1;
      position: relative;
      transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }

    .split-button-right:hover i {
      color: #0099ff;
    }

    .split-button.single-toggle-action {
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0;
    }

    .split-button.single-toggle-action:active {
      transform: scale(0.98);
    }

    .split-button-content {
      display: flex;
      align-items: center;
      padding: 10px 0px 10px 6px;
      flex-grow: 1;
      font-weight: bold;
      color: #1e293b;
      gap: 0px;
    }

    .split-button-content i {
      color: #8f8e8e;
      font-size: 13px;
    }

    .split-button-icon {
      padding: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease;
    }

    .split-button.single-toggle-action .split-button-right,
    .split-button.single-toggle-action .split-button-icon {
      border-left: none;
      background: transparent;
    }

    .split-button.single-toggle-action:hover {
      background: rgba(255, 255, 255, 0.95);
    }

    .split-button.single-toggle-action[aria-expanded="true"] .split-button-icon i {
      transform: rotate(180deg);
    }

    .split-button.single-toggle-action .split-button-content {
      cursor: pointer;
    }

    /* Desktop Dropdown Specifics */
    @media (min-width: 993px) {
      .navbar .mobile-dropdown {
        position: absolute;
        top: 56px;
        left: 50%;
        transform: translateX(-50%) translateY(10px);
        width: 200px;
        background: rgb(255 255 255);
        backdrop-filter: blur(20px);
        border-radius: 19px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
        padding: 10px;
        opacity: 0;
        visibility: hidden;
        overflow: visible;
        display: block !important;
        max-height: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 1100;
      }

      .navbar .mobile-dropdown-item.active .mobile-dropdown {
        opacity: 1;
        visibility: visible;
        transform: translateX(-50%) translateY(0);
      }

      .navbar .mobile-dropdown::before {
        content: '';
        position: absolute;
        top: -16px;
        left: 50%;
        transform: translateX(-50%);
        width: 32px;
        height: 32px;
        background-color: #ffffff;
        -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 0C12 8 20 12 24 12C20 12 12 20 12 24C12 20 4 12 0 12C4 12 12 8 12 0Z'/%3E%3C/svg%3E");
        mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 0C12 8 20 12 24 12C20 12 12 20 12 24C12 20 4 12 0 12C4 12 12 8 12 0Z'/%3E%3C/svg%3E");
        -webkit-mask-size: contain;
        mask-size: contain;
        -webkit-mask-repeat: no-repeat;
        mask-repeat: no-repeat;
        filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
        clip-path: none;
        mix-blend-mode: darken;
        box-shadow: none;
      }

      .navbar .mobile-dropdown li {
        margin: 0;
      }

      .navbar .mobile-dropdown a {
        background: transparent;
        color: #334155;
        font-weight: 500;
        padding: 10px 15px;
        border-radius: 10px;
        text-align: left;
        border: none;
        display: block;
      }

      .navbar .mobile-dropdown a:hover {
        background: rgba(0, 153, 255, 0.08);
        color: #0099ff;
        padding-left: 20px;
      }
    }

    /* Dark Mode Toggle Buttons */
    .theme-toggle-btn {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #333;
      margin: 0 8px;
    }

    .theme-toggle-btn:hover {
      background: rgba(0, 153, 255, 0.1);
      border-color: #0099ff;
      transform: scale(1.1);
    }

    .theme-toggle-btn i {
      font-size: x-large;
      transition: color 0.3s ease;
    }

    body.dark-mode .theme-toggle-btn {
      color: #fff;
      border-color: rgba(255, 255, 255, 0.3);
    }

    body.dark-mode .theme-toggle-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.5);
    }

    /* Mobile theme toggle button styling */
    .footer-btn {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 10px 15px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: inherit;
      width: 100%;
      justify-content: flex-start;
    }

    .footer-btn:hover {
      background: rgba(0, 153, 255, 0.1);
      border-color: #0099ff;
    }

    body.dark-mode .footer-btn {
      color: #fff;
      border-color: rgba(255, 255, 255, 0.3);
    }

    body.dark-mode .footer-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.5);
    }

    /* Hide mobile theme toggle on desktop */
    @media (min-width: 769px) {
      #mobile-theme-toggle {
        display: none !important;
      }
    }

    /* Hide desktop theme toggle on mobile */
    @media (max-width: 768px) {
      #desktop-theme-toggle {
        display: none !important;
      }
    }

    /* Profile Dropdown Enhancements */
    .profile-dropdown-container {
      list-style: none;
      position: absolute !important;
      top: 10vh;
      right: 72px;
      z-index: 1000;
      background: white;
      border-radius: 20px;
      padding: 0px;
      box-shadow: 0px 24px 25px -2px rgba(0, 0, 0, 0.1);
      display: none;
      opacity: 0;
      transform: translateY(-10px);
    }

    .profile-dropdown-container.active {
      display: block;
    }

    .profile-dropdown-container.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .profile-dropdown-container .profile-dropdown {
      position: static;
      opacity: 1;
      border-radius: 20px;
      visibility: visible;
      transform: none;
      box-shadow: none;
      overflow: hidden;
      background: transparent;
      padding: 0;
      width: 100%;
      min-width: 260px;
    }

    .profile-dropdown-list {
      justify-items: flex-start;
      padding-top: 5px;
    }

    .profile-dropdown-divider {
      border: 1px solid #80808038;
    }

    .profile-icon-btn {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid #33333367;
      background: grey;
    }

    .profile-icon-placeholder {
      color: #ffffff;
      font-size: 20px;
      margin: 10px;
    }


    .profile-header {
      padding: 15px 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .profile-info {
      display: flex;
      flex-direction: column;
    }

    .profile-name {
      font-weight: 600;
      color: #333;
      margin: 0;
      font-size: 16px;
      line-height: 1.2;
    }

    .profile-email {
      color: #666;
      font-size: 13px;
      margin: 4px 0 0 0;
      line-height: 1.2;
    }

    body.dark-mode .profile-name {
      color: #fff;
    }

    body.dark-mode .profile-email {
      color: #aaa;
    }

    /* Mobile Sidebar Profile Styles */
    .header-profile {
      display: none;
      align-items: center;
      gap: 6px;
      padding: 15px 0px 15px 4px;
      cursor: pointer;
      scale: 1.05;
      border-radius: 8px;
      transition: background-color 0.2s;
      width: 100%;
    }

    .header-profile:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    body.dark-mode .header-profile:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }

    #navbar-avatar-img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #0099ff;
    }

    .header-profile .user-info {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .header-profile .user-name {
      font-weight: 600;
      font-size: 16px;
      color: #333;
      line-height: 1.2;
    }

    body.dark-mode .header-profile .user-name {
      color: #fff;
    }

    .header-profile .user-email {
      font-size: 13px;
      color: #666;
      line-height: 1.2;
    }

    body.dark-mode .header-profile .user-email {
      color: #bbb;
    }

    .profile-dropdown-container {
      z-index: 2100 !important;
    }

    .thebigthree-btns-wrapper {
      display: flex;
      align-items: center;
      border-radius: 50px;
      border: 1px solid #414141;
      padding: 0px 4px 0px 0px;
    }

    /* Navigation Links Hover Effect - Radial Expanding Background */
    .split-button.single-toggle-action,
    .navbar a {
      position: relative;
      overflow: hidden;
      z-index: 1;
    }

    .split-button.single-toggle-action::before,
    .navbar a::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      background-color: #ccebff;
      border-radius: 50%;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
      z-index: -1;
    }

    .split-button.single-toggle-action:hover::before,
    .navbar a:hover::before {
      transform: translate(-50%, -50%) scale(2);
      opacity: 1;
    }

    body.dark-mode .split-button.single-toggle-action::before,
    body.dark-mode .navbar a::before {
      background-color: #ccebff;
      transition: all 1.1s cubic-bezier(0.04, 0.86, 0, 1.08);
    }

    .split-button-content,
    .split-button-icon,
    .navbar a {
      position: relative;
      z-index: 1;
    }

    #main-nav-link {
      background-color: transparent !important;
      padding: 3px !important;
    }

    /* Logout Modal Styles */
    .logout-modal-overlay {
      background-color: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
    }

    .logout-modal-content {
      background: white;
      border-radius: 20px;
      max-width: 450px;
      width: 90%;
      position: fixed !important;
      place-self: anchor-center;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      border: none;
      padding: 0;
      overflow: hidden;
      z-index: 2001;
    }

    .logout-modal-header {
      padding: 30px 30px 20px;
      text-align: center;
      background: linear-gradient(135deg, #0099ff, #00c11b);
      color: white;
      position: relative;
    }

    .logout-icon {
      width: 60px;
      height: 60px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      font-size: 24px;
    }

    .logout-modal-header h3 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
      color: white;
    }

    .logout-modal-body {
      padding: 25px 30px;
      text-align: center;
    }

    .logout-modal-body p {
      margin: 0;
      font-size: 16px;
      line-height: 1.6;
      color: #64748b;
    }

    .logout-modal-actions {
      padding: 20px 30px 30px;
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .logout-confirm-btn {
      background: #ad000021;
      border: none;
      padding: 12px 24px;
      border-radius: 12px;
      color: white;
      border: 1px #ff3939 solid;
      box-shadow: none;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 120px;
      height: 44px;
      position: relative;
      overflow: hidden;
    }

    .logout-confirm-btn:hover {
      background: #ad000021;
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
    }

    .logout-confirm-btn:active {
      transform: translateY(0);
    }

    .logout-cancel-btn {
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      padding: 12px 24px;
      border-radius: 12px;
      color: #64748b;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 100px;
    }

    .logout-cancel-btn:hover {
      background: #f1f5f9;
      border-color: #cbd5e1;
      color: #475569;
    }

    /* Loading state for logout button */
    .logout-confirm-btn.loading {
      pointer-events: none;
      opacity: 0.7;
    }

    .logout-confirm-btn.loading .btn-text {
      opacity: 0;
      visibility: hidden;
    }

    .logout-confirm-btn .btn-text {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      position: relative;
      z-index: 2;
    }

    .logout-confirm-btn.loading .custom-spinner {
      display: flex;
    }

    .custom-spinner {
      display: none;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      align-items: center;
      justify-content: center;
    }

    /* Dark mode styles for logout modal */
    body.dark-mode .logout-modal-content {
      background: #1e293b;
      color: #f1f5f9;
    }

    body.dark-mode .logout-modal-body p {
      color: #94a3b8;
    }

    body.dark-mode .logout-cancel-btn {
      background: rgba(51, 65, 85, 0.5);
      border-color: #334155;
      color: #94a3b8;
    }

    body.dark-mode .logout-cancel-btn:hover {
      background: rgba(51, 65, 85, 0.8);
      border-color: #475569;
      color: #f1f5f9;
    }

    /* Responsive design for logout modal */
    @media (max-width: 480px) {
      .logout-modal-content {
        width: 95%;
        margin: 20px auto;
      }

      .logout-modal-header,
      .logout-modal-body,
      .logout-modal-actions {
        padding-left: 20px;
        padding-right: 20px;
      }

      .logout-modal-header {
        padding-top: 25px;
        padding-bottom: 15px;
      }

      .logout-modal-body {
        padding-top: 20px;
        padding-bottom: 20px;
      }

      .logout-modal-actions {
        padding-bottom: 25px;
        flex-direction: column;
      }

      .logout-confirm-btn,
      .logout-cancel-btn {
        width: 100%;
        min-width: unset;
      }
    }

    /* Spinner Styles for Logout Button */
    .spinner {
      font-size: 20px;
      position: relative;
      display: block;
      width: 1em;
      height: 1em;
    }

    .spinner .spinner-blade {
      position: absolute;
      left: 0.4629em;
      bottom: 0;
      width: 0.074em;
      height: 0.2777em;
      border-radius: 0.0555em;
      background-color: white;
      -webkit-transform-origin: center -0.2222em;
      -ms-transform-origin: center -0.2222em;
      transform-origin: center -0.2222em;
      animation: spinner-fade9234 1s infinite linear;
    }

    .spinner .spinner-blade:nth-child(1) {
      -webkit-animation-delay: 0s;
      animation-delay: 0s;
      -webkit-transform: rotate(0deg);
      -ms-transform: rotate(0deg);
      transform: rotate(0deg);
    }

    .spinner .spinner-blade:nth-child(2) {
      -webkit-animation-delay: 0.083s;
      animation-delay: 0.083s;
      -webkit-transform: rotate(30deg);
      -ms-transform: rotate(30deg);
      transform: rotate(30deg);
    }

    .spinner .spinner-blade:nth-child(3) {
      -webkit-animation-delay: 0.166s;
      animation-delay: 0.166s;
      -webkit-transform: rotate(60deg);
      -ms-transform: rotate(60deg);
      transform: rotate(60deg);
    }

    .spinner .spinner-blade:nth-child(4) {
      -webkit-animation-delay: 0.249s;
      animation-delay: 0.249s;
      -webkit-transform: rotate(90deg);
      -ms-transform: rotate(90deg);
      transform: rotate(90deg);
    }

    .spinner .spinner-blade:nth-child(5) {
      -webkit-animation-delay: 0.332s;
      animation-delay: 0.332s;
      -webkit-transform: rotate(120deg);
      -ms-transform: rotate(120deg);
      transform: rotate(120deg);
    }

    .spinner .spinner-blade:nth-child(6) {
      -webkit-animation-delay: 0.415s;
      animation-delay: 0.415s;
      -webkit-transform: rotate(150deg);
      -ms-transform: rotate(150deg);
      transform: rotate(150deg);
    }

    .spinner .spinner-blade:nth-child(7) {
      -webkit-animation-delay: 0.498s;
      animation-delay: 0.498s;
      -webkit-transform: rotate(180deg);
      -ms-transform: rotate(180deg);
      transform: rotate(180deg);
    }

    .spinner .spinner-blade:nth-child(8) {
      -webkit-animation-delay: 0.581s;
      animation-delay: 0.581s;
      -webkit-transform: rotate(210deg);
      -ms-transform: rotate(210deg);
      transform: rotate(210deg);
    }

    .spinner .spinner-blade:nth-child(9) {
      -webkit-animation-delay: 0.664s;
      animation-delay: 0.664s;
      -webkit-transform: rotate(240deg);
      -ms-transform: rotate(240deg);
      transform: rotate(240deg);
    }

    .spinner .spinner-blade:nth-child(10) {
      -webkit-animation-delay: 0.747s;
      animation-delay: 0.747s;
      -webkit-transform: rotate(270deg);
      -ms-transform: rotate(270deg);
      transform: rotate(270deg);
    }

    .spinner .spinner-blade:nth-child(11) {
      -webkit-animation-delay: 0.83s;
      animation-delay: 0.83s;
      -webkit-transform: rotate(300deg);
      -ms-transform: rotate(300deg);
      transform: rotate(300deg);
    }

    .spinner .spinner-blade:nth-child(12) {
      -webkit-animation-delay: 0.913s;
      animation-delay: 0.913s;
      -webkit-transform: rotate(330deg);
      -ms-transform: rotate(330deg);
      transform: rotate(330deg);
    }

    @keyframes spinner-fade9234 {
      0% {
        background-color: #ffffff;
      }

      100% {
        background-color: rgb(3, 3, 3);
      }
    }


    .button {
      all: unset;
      position: relative;
      display: inline-flex;
      height: 2.5rem;
      align-items: center;
      border-radius: 9999px;
      padding-left: 2rem;
      padding-right: 2rem;
      font-family: Segoe UI;
      font-size: 1.2rem;
      font-weight: 640;
      color: #ffffff;
      letter-spacing: -0.06em;
      cursor: pointer;
    }

    .button-item {
      background-color: transparent;
      color: #000000;
    }

    .button-item .button-bg {
      border-color: rgb(255, 255, 255);
      background-color: rgb(255, 255, 255);
    }

    .button-inner,
    .button-inner-hover,
    .button-inner-static {
      pointer-events: none;
      display: block;
    }

    .button-inner {
      position: relative;
    }

    .button-inner-hover {
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transform: translateY(70%);
    }

    .button-bg {
      overflow: hidden;
      border-radius: 2rem;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      transform: scale(1);
      transition: transform 1.8s cubic-bezier(0.19, 1, 0.22, 1);
    }

    .button-bg,
    .button-bg-layer,
    .button-bg-layers {
      display: block;
    }

    .button-bg-layers {
      position: absolute;
      left: 50%;
      transform: translate(-50%);
      top: -60%;
      aspect-ratio: 1 / 1;
      width: max(200%, 10rem);
    }

    .button-bg-layer {
      border-radius: 9999px;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      transform: scale(0);
    }

    .button-bg-layer.-purple {
      background-color: rgb(26, 80, 255);
    }

    .button-bg-layer.-turquoise {
      background-color: rgb(9, 255, 218);
    }

    .button-bg-layer.-yellow {
      --tw-bg-opacity: 1;
      background: linear-gradient(45deg, rgb(3, 226, 255), rgb(0, 89, 255));
    }

    .button:hover .button-inner-static {
      opacity: 0;
      transform: translateY(-70%);
      transition:
        transform 1.4s cubic-bezier(0.19, 1, 0.22, 1),
        opacity 0.3s linear;
    }

    .button:hover .button-inner-hover {
      opacity: 1;
      transform: translateY(0);
      transition:
        transform 1.4s cubic-bezier(0.19, 1, 0.22, 1),
        opacity 1.4s cubic-bezier(0.19, 1, 0.22, 1);
    }

    .button:hover .button-bg-layer {
      transition:
        transform 1.3s cubic-bezier(0.19, 1, 0.22, 1),
        opacity 0.3s linear;
    }

    .button:hover .button-bg-layer-1 {
      transform: scale(1);
    }

    .button:hover .button-bg-layer-2 {
      transition-delay: 0.1s;
      transform: scale(1);
    }

    .button:hover .button-bg-layer-3 {
      transition-delay: 0.2s;
      transform: scale(1);
    }
  </style>

  <!-- Core Dependencies (No defer for immediate availability) -->
  <script src="js/db-client.js"></script>

  <!-- Authentication & Profile System -->
  <script src="js/profile-dropdown.js" defer></script>
  <script src="js/logout-injector.js" defer></script>
  <script src="js/logout-modal.js"></script>

  <!-- UI Functionality -->
  <script src="js/mobile-sidebar.js" defer></script>
  <script src="js/darkmode.js" defer></script>

  <!-- Cart and Order Management -->
  <script src="js/cart.js" defer></script>
  <script src="js/order-manager.js" defer></script>
  <script src="js/cart-manager.js" defer></script>
  <script src="js/cookie-manager.js" defer></script>

  <!-- Navigation and App Scripts -->
  <script src="js/navigation.js" defer></script>
  <script src="js/dollar-font.js" defer></script>
  <script src="js/checkout.js"></script>
  <script src="js/search-integration.js"></script>
  <script src="js/app.js" defer></script>

  <!-- Authentication Integration -->
  <script>
    // Simple Auth Check for Navbar
    document.addEventListener('dbReady', async () => {
      const { data: { user } } = await DB.getUser();
      if (user) {
        // Update Login Links to Profile
        document.querySelectorAll('a[href="login.html"]').forEach(link => {
          link.textContent = 'My Profile';
          link.href = 'profile.html';
          link.innerHTML = '<i class="fas fa-user-circle"></i> My Profile';
        });
      }
    });
  </script>
</head>

<body>
  <nav>
    <div class="navbar-container">
      <a href="index.html" aria-label="Navigate to home page">
        <div class="navbar-logo">
          <img src="assets/BlueEmber-ezgif.com-gif-maker.gif" alt="Blue Ember animated logo"
            style="width: 30px;height: auto;">
          <span>
            <h6 style="color: #0099ff;font-size: large;margin: 0px 0px -6px 0px;">BLUE</h6>
            <h6 style="color: #000000;font-size: large;margin: 0px 0px -6px 0px;">EMBER</h6>
          </span>
        </div>
      </a>

      <!-- Search Bar -->
      <div class="search-container">
        <form action="search-results.html" method="GET" id="searchForm">
          <input type="search" class="search-input" id="searchInput" name="q" placeholder="Search..."
            aria-label="Search products">
          <button type="submit" class="search-button" aria-label="Search">
            <i class='bx  bx-search-big'></i>
          </button>
        </form>
      </div>

      <div class="hamburger" id="hamburger">
        <i class="fa-solid fa-bars"></i>
      </div>
      <div class="cart-icon-cont-0">
        <div class="cart-link">
          <i class="fa-solid fa-cart-shopping"></i>
          <span class="cart-count" id="cart-count">0</span>
        </div>
      </div>
      <!-- Main navigation menu -->
      <ul class="navbar">
        <li class="mobile-dropdown-item" id="main-nav-link">
          <div class="split-button single-toggle-action">
            <div class="split-button-content">
              <i class='bx  bx-menu'></i>
              Categories
            </div>
            <div class="split-button-icon">
              <i class="fa-solid fa-chevron-down"></i>
            </div>
          </div>
          <ul class="mobile-dropdown">
            <li><a href="product2.html">Toys</a></li>
            <li><a href="product2.html">Supplyments</a></li>
            <li><a href="product2.html">Beauty</a></li>
            <li><a href="product2.html">HomeGoods</a></li>
          </ul>
        </li>
        <li class="mobile-dropdown-item" id="main-nav-link">
          <div class="split-button single-toggle-action">
            <div class="split-button-content">
              <i class="fa-solid fa-building"></i>
              Brands
            </div>
            <div class="split-button-icon">
              <i class="fa-solid fa-chevron-down"></i>
            </div>
          </div>
          <ul class="mobile-dropdown">
            <li><a href="samsung-productpage.html">Samsung</a></li>
            <li><a href="LG-productpage.html">LG</a></li>
            <li><a href="Whirlpool-productpage.html">Whirlpool</a></li>
            <li><a href="BOSCH-productpage.html">Bosch</a></li>
            <li><a href="Revlon-productpage.html">Revlon</a></li>
            <li><a href="Toys-r-us-productpage.html">Toys R Us</a></li>
          </ul>
        </li>
        <li style="display: none;"><a href="product2.html">Product</a></li>
        <li><a href="compare.html" style="display: none;"><i class='bx  bxs-compare'></i> Compare</a></li>
        <li><a href="Contact.html">Contact</a></li>
        <!-- Profile Dropdown -->

        <div class="profile-dropdown-container" id="profileDropdownContainer">
          <div class="profile-dropdown" id="profileDropdown">
            <!-- Profile Header Added by Fix -->
            <div class="profile-header">
              <img src="assets/profilepreview.jpg" alt="User" id="dropdownHeaderImg"
                style="width: 50px;border-radius: 50%;height: 50px;">
              <div class="profile-info">
                <p id="profileDropdownName" class="profile-name">Guest</p>
                <p id="profileDropdownEmail" class="profile-email">Please log in</p>
              </div>
            </div>
            <div class="profile-dropdown-divider"></div>

            <ul class="profile-dropdown-list">
              <li>
                <a href="profile.html" class="profile-dropdown-item">
                  <i class="fa-regular fa-user"></i>
                  <span>Profile</span>
                </a>
              </li>
              <li>
                <a href="#" class="profile-dropdown-item">
                  <i class="fa-regular fa-comments"></i>
                  <span>Purchases & Reviews</span>
                </a>
              </li>

              <li>
                <a href="account.html" class="profile-dropdown-item">
                  <i class="fa-solid fa-toggle-off"></i>
                  <span>Account Settings</span>
                </a>
              </li>
            </ul>
            <div class="profile-dropdown-divider"></div>
            <ul class="profile-dropdown-list">
              <li>
                <a href="Contact.html" class="profile-dropdown-item">
                  <i class="fa-regular fa-circle-question"></i>
                  <span>Help center</span>
                </a>
              </li>
              <li>
                <a href="#" class="profile-dropdown-item" id="nav-dropdown-logout">
                  <i class="fas fa-sign-out-alt"></i>
                  <span>Logout</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
        </li>
        <div class="thebigthree-btns-wrapper" style="display: flex; align-items: center;">
          <li id="dark-mode-li" style="font-size:22px; display: flex; align-items: center; margin:0 !important;">

          </li>
          <div class="wishlist-icon-container" id="wishlist-toggle">
            <div class="wishlist-link">
              <i class='bx bx-heart'></i>
              <span class="wishlist-count">0</span>
            </div>
          </div>
          <!-- Cart icon moved OUTSIDE the main navbar list, the profile button is by default stays displayed none until signed up, when client log out, the profile button will be displayed none -->
          <button class="profile-icon-btn" id="profileIconBtn" aria-label="Open profile menu"
            style="display: none; align-items: center;">
            <img src="assets/profilepreview.jpg" alt="Profile" id="profileIconImg" class="profile-icon-img">
            <i class="fa-solid fa-user profile-icon-placeholder"></i>
          </button>
          <li class="thebigthree-login/signup-btn">
            <button class="button button-item" id="signupNavBtn">
              <span class="button-bg">
                <span class="button-bg-layers">
                  <span class="button-bg-layer button-bg-layer-1 -purple"></span>
                  <span class="button-bg-layer button-bg-layer-2 -turquoise"></span>
                  <span class="button-bg-layer button-bg-layer-3 -yellow"></span>
                </span>
              </span>
              <span class="button-inner">
                <span class="button-inner-static">SignUp</span>
                <span class="button-inner-hover" style="color: #ffffff;">SignUp</span>
              </span>
            </button>



          </li>
          <div class="cart-icon-container cart-link">
            <div class="cart-link">
              <i class="fa-solid fa-cart-shopping"></i>
              <span class="cart-count">0</span>
            </div>
          </div>

        </div>


      </ul>
    </div>
  </nav>

  <!-- Cart Popup Overlay -->
  <div class="cart-popup-overlay" id="cart-overlay"></div>

  <!-- Cart Popup -->
  <div class="cart-popup" id="cart-popup">
    <div class="cart-header">
      <h3><i class="fa-solid fa-cart-shopping me-2"></i> Your Shopping Cart <span id="cart-item-count">(0)</span></h3>
      <button class="cart-close" id="cart-close"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="cart-items" id="cart-items-container">
      <!-- Cart items will be populated here dynamically -->
    </div>
    <div class="cart-footer">
      <div class="cart-total">
        <span>Total:</span>
        <span id="cart-total">$0.00</span>
      </div>
      <button class="checkout-btn" id="checkout-btn" disabled>
        <span class="payment-icon"></span>Proceed to Checkout</button>
      <button class="continue-btn" id="continue-btn"><i class="fa-solid fa-arrow-left me-2"></i>Continue
        Shopping</button>
    </div>
  </div>

  <!-- Wishlist Popup Overlay -->
  <div class="wishlist-overlay" id="wishlist-overlay"></div>

  <!-- Revamped Wishlist Drawer -->
  <div class="wishlist-popup" id="wishlist-popup">
    <div class="cart-header">
      <h3><i class='bx bxs-heart'></i> My Wishlist</h3>
      <button id="wishlist-close" aria-label="Close wishlist"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="cart-items" id="wishlist-items-container">
      <!-- Dynamically populated -->
    </div>
    <div class="cart-footer">
      <button class="continue-btn" id="wishlist-continue" style="width: 100%; border-radius: 8px; background: #1a1a1a;">
        <i class="fa-solid fa-arrow-left me-2"></i>Continue Shopping
      </button>
    </div>
  </div>

  <!-- Mobile Sidebar Menu (Redesigned) -->
  <div class="mobile-menu" id="mobileMenu">

    <!-- 1. Header: Brand or User Profile -->
    <div class="sidebar-header" id="sidebarHeader">
      <!-- Default State: Brand Logo -->
      <div class="header-brand default-brand" id="sidebarBrand">
        <div class="navbar-logo">
          <img src="assets/BlueEmber-ezgif.com-gif-maker.gif" alt="Blue Ember animated logo"
            style="width: 30px;height: auto;">
          <span>
            <h6 style="color: #0099ff;font-size: large;margin: 0px 0px -6px 0px;">BLUE</h6>
            <h6 style="color: #000000;font-size: large;margin: 0px 0px -6px 0px;">EMBER</h6>
          </span>
        </div>
      </div>

      <!-- User State (Logged In) -->
      <div class="header-profile" id="sidebarProfileContainer">
        <img src="assets/profilepreview.jpg" alt="Profile" id="navbar-avatar-img">
        <div class="user-info">
          <span class="user-name" id="sidebarUserName">User Name</span>
          <span class="user-email" id="sidebarUserEmail">email@example.com</span>
        </div>
        <i class='bx  bx-chevron-down'></i>
      </div>

      <!-- Close Button -->
      <button class="close-btn" id="closeBtn" aria-label="Close menu"
        style="right: -19px;padding: inherit;display: flex;position: relative;">
        <i class='bx  bx-caret-big-left'></i>
      </button>


      <!-- Mobile Specific Profile Dropdown (Floating) -->
      <div class="mobile-profile-dropdown" id="mobileProfileDropdown" style="display: none;">

        <div class="mobile-dropdown-items">
          <a href="profile.html" class="mobile-dropdown-item mobile-item-links">
            <i class="fa-regular fa-user"></i> Profile
          </a>
          <a href="account.html" class="mobile-dropdown-item mobile-item-links">
            <i class="fa-solid fa-toggle-off"></i> Account Settings
          </a>
          <a href="profile.html" class="mobile-dropdown-item mobile-item-links">
            <i class="fa-regular fa-comments"></i> Purchases & Reviews
          </a>
          <a href="Contact.html" class="mobile-dropdown-item mobile-item-links">
            <i class="fa-regular fa-circle-question"></i> Help Center
          </a>
        </div>
      </div>
    </div>

    <!-- 2. Content: Navigation Links -->
    <div class="sidebar-content">

      <a href="index.html" class="sidebar-nav-item">
        <i class="fa-solid fa-house"></i>
        <span>Home</span>
      </a>

      <!-- Collapsible: Categories -->
      <div class="sidebar-collapsible" id="col-categories">
        <button class="collapsible-trigger">
          <div style="display:flex; align-items:center;">
            <i class='bx  bx-categories'></i>
            <span>Categories</span>
          </div>
          <i class="fa-solid fa-chevron-down chevron"></i>
        </button>
        <div class="collapsible-content">
          <a href="product2.html" class="sub-link">Toys</a>
          <a href="product2.html" class="sub-link">Supplyments</a>
          <a href="product2.html" class="sub-link">Beauty</a>
          <a href="product2.html" class="sub-link">HomeGoods</a>
        </div>
      </div>

      <!-- Collapsible: Brands -->
      <div class="sidebar-collapsible" id="col-brands">
        <button class="collapsible-trigger">
          <div style="display:flex; align-items:center;">
            <i class="fa-solid fa-building trigger-icon"></i>
            <span>Brands</span>
          </div>
          <i class="fa-solid fa-chevron-down chevron"></i>
        </button>
        <div class="collapsible-content">
          <a href="samsung-productpage.html" class="sub-link">Samsung</a>
          <a href="LG-productpage.html" class="sub-link">LG</a>
          <a href="Whirlpool-productpage.html" class="sub-link">Whirlpool</a>
          <a href="BOSCH-productpage.html" class="sub-link">Bosch</a>
          <a href="Electrolux-productpage.html" class="sub-link">Revlon</a>
          <a href="Apple-productpage.html" class="sub-link">Toys R Us</a>
        </div>
      </div>

      <a href="product2.html" class="sidebar-nav-item">
        <i class="fa-solid fa-tags"></i>
        <span>Products</span>
      </a>

      <a href="Contact.html" class="sidebar-nav-item">
        <i class="fa-solid fa-envelope"></i>
        <span>Contact Us</span>
      </a>

      <!-- Dynamic Cart Link -->
      <li>
        <a href="#" id="mobile-cart-link" class="mobile-cart-link">
          <i class="fa-solid fa-cart-shopping me-2"></i>Shopping Cart
        </a>
      </li>

      <!-- Login Link (Hidden if logged in) -->
      <div id="sidebar-login-container">
        <a href="login.html" class="sidebar-nav-item" id="sidebar-login-link">
          <i class="fa-solid fa-right-to-bracket"></i>
          <span>Login</span>
        </a>
      </div>

    </div>

    <!-- 3. Footer: Settings / Logout -->
    <div class="sidebar-footer" id="sidebarFooter">
      <button id="mobile-theme-toggle" class="footer-btn">
        <i class="fa-solid fa-moon"></i>
        <span>Toggle Theme</span>
      </button>

      <!-- Logout will be injected here -->
    </div>

  </div>

  <div class="container-fluid search-results-page-layout" style="place-items: anchor-center;">
    <div class="row w-100">
      <!-- Filters Sidebar Redesign -->
      <div class="col-lg-3 col-md-4">
        <button class="mobile-filters-btn" type="button" id="filters-toggle">
          <i class='bx bx-filter-alt'></i> Filter & Sort
        </button>

        <div class="filters-backdrop" id="filters-backdrop"></div>

        <div class="filters-section" id="filters-section">
          <div class="filter-header">
            <h4><i class='bx bx-slider-alt'></i> Parameters</h4>
            <button class="filter-close" id="filter-close" aria-label="Close filters">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>

          <!-- Sort Options -->
          <div class="filter-group">
            <h5><i class='bx bx-sort-z-a'></i> Sort By</h5>
            <select id="sort-select" class="form-select">
              <option value="relevance">Relevance</option>
              <option value="price-asc">Price: Low to High</option>
              <option value="price-desc">Price: High to Low</option>
              <option value="name-asc">Name: A to Z</option>
              <option value="name-desc">Name: Z to A</option>
              <option value="brand-asc">Brand: A to Z</option>
              <option value="brand-desc">Brand: Z to A</option>
            </select>
          </div>

          <!-- Brand Filters (Populated by JS) -->
          <div class="filter-group">
            <h5><i class='bx bx-purchase-tag-alt'></i> Brands</h5>
            <div id="brand-filters" class="custom-checkbox-list">
              <!-- Dynamically populated -->
            </div>
          </div>

          <!-- Price Range Filter -->
          <div class="filter-group border-0">
            <h5><i class='bx bx-dollar-circle'></i> Price Range</h5>
            <div class="price-range-values">
              <span id="min-price-value">$0</span>
              <span id="max-price-value">$5,000</span>
            </div>
            <div class="slider-container">
              <input type="range" class="price-range-slider" id="min-price" min="0" max="5000" value="0">
              <input type="range" class="price-range-slider" id="max-price" min="0" max="5000" value="5000">
            </div>
          </div>

          <button id="clear-filters" class="w-100">
            <i class='bx bx-reset'></i> Reset Filters
          </button>
        </div>
      </div>

      <!-- Results Section -->
      <!-- Results Section -->
      <div class="col-lg-9 col-md-8">
        <div class="results-meta d-flex justify-content-between align-items-center mb-4">
          <div id="results-info" class="results-count">
            <!-- Results count populated by JS -->
          </div>

          <div class="sort-container d-none d-md-flex align-items-center">
            <label for="mobile-sort-select">Sort:</label>
            <select id="mobile-sort-select" class="form-select" style="width: auto;">
              <option value="relevance">Relevance</option>
              <option value="price-asc">Low to High</option>
              <option value="price-desc">High to Low</option>
              <option value="name-asc">A to Z</option>
              <option value="name-desc">Z to A</option>
            </select>
          </div>
        </div>

        <!-- Essential ID for search.js -->
        <div id="no-results" class="no-results text-center py-5" style="display: none;">
          <i class='bx bx-search-alt-2' style="font-size: 4rem; color: #cbd5e1;"></i>
          <h3 class="mt-3">No products found</h3>
          <p class="text-muted">Try different keywords or adjust your filters</p>
        </div>

        <div id="results-container">
          <!-- Results populated by JS -->
          <div class="text-center py-5 no-search-notice">
            <i class='bx bx-loader-alt bx-spin' style="font-size: 3rem; color: var(--primary);"></i>
            <p class="mt-3 text-muted">Loading your query...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Inline UI Logic (Backdrop & Mobile UI) -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const backdrop = document.getElementById('filters-backdrop');
      const filters = document.getElementById('filters-section');
      const toggleBtn = document.getElementById('filters-toggle');
      const closeBtn = document.getElementById('filter-close');

      function openFilters() {
        console.log('Opening filters...');
        if (filters) filters.classList.add('show');
        if (backdrop) {
          backdrop.style.display = 'block';
          setTimeout(() => backdrop.classList.add('show'), 10);
        }
        document.body.style.overflow = 'hidden';
      }

      function closeFilters() {
        console.log('Closing filters...');
        if (filters) filters.classList.remove('show');
        if (backdrop) {
          backdrop.classList.remove('show');
          setTimeout(() => {
            if (!backdrop.classList.contains('show')) {
              backdrop.style.display = 'none';
            }
          }, 400);
        }
        document.body.style.overflow = '';
      }

      if (toggleBtn) {
        toggleBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          openFilters();
        });
      }

      if (closeBtn) {
        closeBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          closeFilters();
        });
      }

      if (backdrop) {
        backdrop.addEventListener('click', (e) => {
          closeFilters();
        });
      }

      // SHOW UP THE PRODUCTS: Trigger search even if query is empty
      setTimeout(() => {
        if (typeof performSearch === 'function') {
          const urlParams = new URLSearchParams(window.location.search);
          const searchTerm = urlParams.get('q') || '';
          performSearch(searchTerm);
        }
      }, 300);
    });
  </script>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3"></div>

  <!-- LOGOUT CONFIRMATION MODAL -->
  <div class="modal" id="logoutModal" aria-hidden="true">
    <div class="modal-overlay logout-modal-overlay" id="logoutModalOverlay"></div>
    <div class="modal-content logout-modal-content" style="place-self: anchor-center;">
      <div class="logout-modal-header">
        <div class="logout-icon">
          <i class="fas fa-sign-out-alt"></i>
        </div>
        <h3>Confirm Logout</h3>
      </div>
      <div class="logout-modal-body">
        <p>Are you sure you want to log out? You'll need to sign in again to access your account.</p>
      </div>
      <div class="logout-modal-actions">
        <button type="button" class="btn btn-secondary logout-cancel-btn" id="logoutCancelBtn">Cancel</button>
        <button type="button" class="btn btn-primary logout-confirm-btn" id="logoutConfirmBtn">
          <span class="btn-text">
            <i class="fas fa-sign-out-alt"></i>
            Log Out
          </span>
          <div class="custom-spinner">
            <div class="spinner center">
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
              <div class="spinner-blade"></div>
            </div>
          </div>
        </button>
      </div>
    </div>
  </div> 
  <footer class="site-footer">
    <div class="footer-container">
      <!-- Brand Section -->
      <div class="footer-section">
        <div class="footer-logo"><a href="index.html">
            <div class="navbar-logo"><img src="assets/BlueEmber-ezgif.com-gif-maker.gif" style="width: 30px;">
              <SPAN>
                <h6 style="color: #0099ff; font-size: large; margin: 0px 0px -6px 0px;">BLUE</h6>
                <H6 style="color: #000000; font-size: large; margin: 0px 0px -6px 0px;">EMBER</H6>
              </SPAN>
            </div>
          </a></div>
        <p class="footer-tagline">Premium Store from trusted global brands. Serving customers since 2005.</p>
      </div>

      <!-- Quick Links -->
      <div class="footer-section">
        <h4>Quick Links</h4>
        <ul>
          <li><a href="terms and services.html">Terms & Services</a></li>
          <li><a href="privacy policy.html">Privacy Policy</a></li>
          <li><a href="Contact.html">Contact</a></li>
          <li><a href="Refund and Exchange.html">Refund & Exchange</a></li>
          <li><a href="About us .html">About Us</a></li>
        </ul>
      </div>

      <!-- Categories -->
      <div class="footer-section">
        <h4>Categories</h4>
        <ul>
          <li><a href="product2.html">Toys</a></li>
          <li><a href="product2.html">Supplyments</a></li>
          <li><a href="product2.html">Beauty</a></li>
          <li><a href="product2.html">HomeGoods</a></li>
        </ul>
      </div>

      <!-- Contact Info -->
      <div class="footer-section">
        <h4>Contact Us</h4>
        <ul>
          <li>
            <a>
              <address>
                <p><a href="https://maps.app.goo.gl/BGBAUvaKPHLhTqvh6">Hasbrouck Heights NJ 07604 USA</a>
                </p>
                <i class="fa-solid fa-phone-volume" style="color:rgb(0, 89, 255)"></i> +1 (800) 123-4567<br>
                <i class="fa-solid fa-envelope" style="color:rgb(0, 89, 255)"></i> <a
                  href="mailto:support@blue-ember.us">support@blue-ember.us</a>
              </address>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 Blue Ember Store. All rights reserved.</p>
      <div class="footer-legal">
        <a href="privacy policy.html">Privacy Policy</a> 
        <a href="terms and services.html">Terms of Service</a> 
      </div>
      <!-- Footer Brand Watermark -->
    <div class="footer-trending">
      <span class="footer-trending-text">BLUE </span>
      <span class="footer-trending-text">EMBER</span>
    </div>
    </div>

    
  </footer>





  <!-- The Pill Navbar -->
  <div class="mobnav" id="mobilePillNavbar">
    <abbr title="Home">
      <div class="nav-item" data-target="home">
        <ion-icon name="home-outline"></ion-icon>
        <span class="nav-text"><a href="index.html"><i class='bx  bx-rotate-cw' title="Reload page"></i></a></span>
      </div>
    </abbr>
    <abbr title="Search">
      <div class="nav-item" data-target="search">
        <ion-icon name="search-outline"></ion-icon>
        <span class="nav-text"><a href="#">Search</a></span>
      </div>
    </abbr>

    <abbr title="Signup">
      <div class="nav-item" data-target="signup" id="Hide/UnhideSignupBtn" style="padding: 0px;">
        <a href="login.html" style="padding: 0px;">
          <li class="thebigthree-login/signup-btn">
            <button class="button button-item" id="signupNavBtn">
              <span class="button-bg">
                <span class="button-bg-layers">
                  <span class="button-bg-layer button-bg-layer-1 -purple"></span>
                  <span class="button-bg-layer button-bg-layer-2 -turquoise"></span>
                  <span class="button-bg-layer button-bg-layer-3 -yellow"></span>
                </span>
              </span>
              <span class="button-inner">
                <span class="button-inner-static">SignUp</span>
                <span class="button-inner-hover" style="color: #ffffff;">SignUp</span>
              </span>
            </button>



          </li>
        </a>
      </div>
    </abbr>
    </a>
    <abbr title="Profile">
      <div class="nav-item" data-target="user" id="Hide/UnhideUserIcon" style="display: none;">
        <ion-icon name="person-outline"></ion-icon>
        <span class="nav-text"><a href="profile.html">User</a></span>
      </div>
    </abbr>
    <abbr title="Shop">
      <div class="nav-item" data-target="shop">
        <ion-icon name="storefront-outline"></ion-icon>
        <span class="nav-text"><a href="product2.html">Shop</a></span>
      </div>
    </abbr>
    <abbr title="Chat with us">
      <div class="nav-item" data-target="chatbot" style="padding:22px;">
        <button id="chat-bubble-btn" class="chat-bubble-btn" aria-label="Chat with us">
          <ion-icon name="chatbubbles-outline"></ion-icon>
          <span class="feature-badge" id="chat-badge-1" style="display:none"><i class='bx bx-sparkles'></i></span>
        </button>
      </div>
    </abbr>



  </div>

  <abbr title="Chat with us">
    <button id="chat-bubble-btn-two" class="chat-bubble-btn" aria-label="Chat with us">
      <ion-icon name="chatbubbles-outline"></ion-icon>
      <span class="feature-badge" id="chat-badge-2" style="display:none"><i class='bx bx-sparkles'></i></span>
    </button>
  </abbr>
  <div id="chat-window" class="chat-window">

    <!-- Header -->
    <div class="chat-header">
      <div class="header-brand">
        <div class="wrapper" style="overflow: unset;margin: -5px;contain: layout;">
          <button class="icon-btn" id="emberSidebarToggle">
            <i class='bx bx-menu'><span class="feature-badge" id="sidebar-toggle-badge" style="display:none"><i
                  class='bx bx-sparkles'></i></span></i>
            <span class="feature-badge" id="sidebar-toggle-badge" style="display:none"><i
                class='bx bx-sparkles'></i></span>
          </button>
        </div>
        <div class="header-brand">
          <!-- From Uiverse.io by dexter-st -->
          <div class="loader-wrapper-chatbot-avatar">
            <span STYLE="FONT-FAMILY:'FontAwesome';z-index:1">E</span>
            <div class="loader-chatbot-avatar"></div>
          </div>

          <span class="header-title">Chatbase AI Agent</span>
        </div>
      </div>
      <button class="icon-btn" id="emberMenuToggle"><i class='bx bx-dots-horizontal-rounded'></i></button>
    </div>

    <!-- Dropdown Menu -->
    <div id="emberDropdown" class="dropdown-menu">
      <button class="menu-item" onclick="EmberCore.startNewChat()"><i class='bx bx-plus'></i> Start a new chat</button>
      <button class="menu-item" onclick="EmberCore.endChat()"><i class='bx bx-x'></i> End chat</button>
      <button class="menu-item" onclick="EmberCore.showRecentChats()"><i class='bx bx-history'></i> View recent
        chats</button>
    </div>

    <!-- Sidebar -->
    <div id="emberSidebar" class="sidebar">
      <h4 style="color:var(--text-main); margin-top:0;">Menu</h4>

      <button class="menu-item" onclick="EmberCore.switchView('notifications')">
        <i class='bx bx-bell'></i> Notifications
        <span class="notification-badge" style="display:none"></span>
      </button>

      <button class="menu-item" onclick="EmberCore.switchView('settings')">
        <i class='bx bx-cog'></i> Settings
      </button>

      <button class="menu-item" onclick="EmberCore.switchView('whatsnew')">
        <i class='bx bx-party'></i> What's new in v2.8
        <span class="feature-badge" id="whatsnew-sidebar-badge" style="display:none"><i
            class='bx bx-sparkles'></i></span>
      </button>

      <button class="menu-item" onclick="EmberCore.switchView('chat')">
        <i class='bx  bx-arrow-s-left'></i> Back to Chat
      </button>
    </div>

    <!-- Drag & Drop Overlay -->
    <div id="emberDropZone" class="drop-overlay">
      <i class='bx bx-cloud-upload' style="font-size: 48px; color: var(--text-sub);"></i>
      <h3 style="color: var(--text-main); margin: 10px 0;">Drop file to upload</h3>
    </div>

    <!-- VIEW: CHAT -->
    <div id="view_chat" class="view-container active">

      <div id="emberChatBody" class="chat-body">
        <!-- Messages Injected Here -->
      </div>

      <!-- Footer Section -->
      <div class="footer-wrapper">




        <!-- Privacy Toast -->
        <div id="privacyToast" class="privacy-toast">
          <span>By chatting, you agree to our <u style="cursor:pointer">privacy policy</u>.</span>
          <i class='bx bx-x' style="font-size:16px; cursor:pointer;"
            onclick="this.parentElement.classList.add('closing')"></i>
        </div>

        <div class="preview-of-file-upload-before-send" id="preview-window-2A">
          <p>Images Uploaded in Chat are Temporary & Deleted after Web reloads.</p>
          <!-- Preview of File Upload Before Send, edit structure if something a miss -->
        </div>
        <!-- Emoji window moved to floating position outside chat -->

        <!-- Input Card -->
        <div class="input-card">
          <div id="emberInput" class="chat-input" contenteditable="true" placeholder="Message..."></div>

          <div class="input-actions">
            <input type="file" id="emberFileInput" class="hidden" multiple onchange="EmberCore.handleFileUpload(this)">

            <!-- Paperclip -->
            <button class="action-btn" title="Attach File" onclick="document.getElementById('emberFileInput').click()">
              <i class='bx bx-paperclip'></i>
            </button>

            <!-- Emojis -->
            <button class="action-btn" id="emoji-trigger" title="Emojis">
              <i class='bx bx-smile'></i>
            </button>

            <!-- Send -->
            <button id="emberSendBtn" class="action-btn" style="color:var(--text-main);">
              <i class='bx bx-send'></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- VIEW: NOTIFICATIONS -->
    <div id="view_notifications" class="view-container">
      <div class="list-view-content">
        <h3 class="list-header">Notifications</h3>
        <div class="list-item">
          <span style="font-weight:600; font-size:14px;">System Update</span>
          <span style="font-size:12px; color:var(--text-sub);">We have updated our privacy policy.</span>
        </div>
        <div class="list-item">
          <span style="font-weight:600; font-size:14px;">New Feature</span>
          <span style="font-size:12px; color:var(--text-sub);">Drag and drop file upload is now available!</span>
        </div>
        <button class="menu-item" onclick="EmberCore.switchView('chat')" style="margin-top:20px">
          <i class='bx  bx-arrow-s-left'></i> Back
        </button>
      </div>
    </div>

    <!-- VIEW: SETTINGS -->
    <div id="view_settings" class="view-container">
      <div class="list-view-content">
        <h3 class="list-header">Settings</h3>
        <div
          style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; color:var(--text-main);">
          <span>Dark Mode</span>
          <input type="checkbox" id="darkModeToggle" onchange="EmberCore.toggleDarkMode(this.checked)">
        </div>
        <button class="menu-item" style="color:red" onclick="localStorage.clear(); location.reload();">
          <i class='bx bx-trash'></i> Clear Data
        </button>
        <button class="menu-item" onclick="EmberCore.switchView('chat')">
          <i class='bx  bx-arrow-s-left'></i> Back
        </button>
      </div>
    </div>

    <!-- VIEW: WHAT'S NEW -->
    <div id="view_whatsnew" class="view-container">
      <div class="list-view-content">
        <h3 class="list-header">What's New in v2.8</h3>
        <div class="whatsnew-content" style="padding: 15px 0; color: var(--text-main);">
          <div class="whatsnew-item" style="margin-bottom: 25px;">
            <h4 style="color: var(--text-main); margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">
              <i class='bx bx-party' style="color: #ff6b6b; margin-right: 8px;"></i>
              Enhanced Chatbot Features
            </h4>
            <p
              style="color: var(--text-sub); margin: 0; font-size: 13.5px; line-height: 1.5; font-weight: 400; letter-spacing: -0.2px;">
              Introducing our most intelligent assistant yet. With a beautifully refined interface and deep
              architectural improvements, the new chatbot feels more human, more responsive, and more capable. It's not
              just a chat; it's a seamless extension of your workflow, designed to understand you better with every
              interaction.
            </p>
          </div>

          <div class="whatsnew-item" style="margin-bottom: 25px;">
            <h4 style="color: var(--text-main); margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">
              <i class='bx bx-sync' style="color: #4facfe; margin-right: 8px;"></i>
              Smart Sync Technology
            </h4>
            <p
              style="color: var(--text-sub); margin: 0; font-size: 13.5px; line-height: 1.5; font-weight: 400; letter-spacing: -0.2px;">
              Your experience, synchronized. Whether you're switching between pages or opening a new tab, your chat
              history and state now travel with you. Experience a truly unified interface where your data is always
              exactly where you left it.
            </p>
          </div>

          <div class="whatsnew-item" style="margin-bottom: 25px;">
            <h4 style="color: var(--text-main); margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">
              <i class='bx bx-palette' style="color: #f093fb; margin-right: 8px;"></i>
              Elegance in Every Pixel
            </h4>
            <p
              style="color: var(--text-sub); margin: 0; font-size: 13.5px; line-height: 1.5; font-weight: 400; letter-spacing: -0.2px;">
              A stunning new dark mode and retina-ready visuals designed to be as easy on the eyes as they are elegant.
              Every animation and shadow has been meticulously tuned for a buttery-smooth, premium feel.
            </p>
          </div>

          <div class="whatsnew-item" style="margin-bottom: 20px;">
            <h4 style="color: var(--text-main); margin: 0 0 8px 0; font-size: 16px;">
              <i class='bx bx-search' style="color: #4ecdc4; margin-right: 8px;"></i>
              Advanced Search Features
            </h4>
            <p style="color: var(--text-sub); margin: 0; font-size: 14px; line-height: 1.4;">
              Real-time product filtering and improved search functionality across all product pages.
            </p>
          </div>

          <div class="whatsnew-item" style="margin-bottom: 20px;">
            <h4 style="color: var(--text-main); margin: 0 0 8px 0; font-size: 16px;">
              <i class='bx bx-mobile' style="color: #45b7d1; margin-right: 8px;"></i>
              Mobile Experience Improvements
            </h4>
            <p style="color: var(--text-sub); margin: 0; font-size: 14px; line-height: 1.4;">
              Enhanced mobile navigation, improved responsive design, and better touch interactions.
            </p>
          </div>

          <div class="whatsnew-item" style="margin-bottom: 20px;">
            <h4 style="color: var(--text-main); margin: 0 0 8px 0; font-size: 16px;">
              <i class='bx bx-bell' style="color: #f9ca24; margin-right: 8px;"></i>
              Smart Notifications
            </h4>
            <p style="color: var(--text-sub); margin: 0; font-size: 14px; line-height: 1.4;">
              Intelligent notification system for order updates, promotions, and important announcements.
            </p>
          </div>

          <div class="whatsnew-item">
            <h4 style="color: var(--text-main); margin: 0 0 8px 0; font-size: 16px;">
              <i class='bx bx-shield' style="color: #6c5ce7; margin-right: 8px;"></i>
              Enhanced Security
            </h4>
            <p style="color: var(--text-sub); margin: 0; font-size: 14px; line-height: 1.4;">
              Improved authentication system and better data protection for user accounts.
            </p>
          </div>
        </div>
        <button class="menu-item" onclick="EmberCore.switchView('chat')" style="margin-top: 20px;">
          <i class='bx bx-arrow-s-left'></i> Back to Chat
        </button>
      </div>
    </div>

    <!-- VIEW: RECENT CHATS -->
    <div id="view_recent" class="view-container">
      <div class="list-view-content">
        <h3 class="list-header">Recent Chats</h3>
        <div id="emberHistoryList" style="display:flex; flex-direction:column;"></div>
        <button class="menu-item" onclick="EmberCore.switchView('chat')">
          <i class='bx  bx-arrow-s-left'></i> Back
        </button>
      </div>
    </div>

  </div>

  <!-- Floating Draggable Emoji Window -->
  <div id="emoji-window-2B" class="Emoji-container emoji-floating-window">
    <div class="emoji-window-header">
      <span class="emoji-window-title">Emojis</span>
      <div class="emoji-drag-handle" title="Drag to move">
        <i class='bx bx-apps'></i>
      </div>
      <button class="emoji-close-btn" title="Close">
        <i class='bx bx-x'></i>
      </button>
    </div>
    <div class="emoji-window-body">
      <!-- Populated by JavaScript for extreme content & performance -->
    </div>
  </div>

  <!-- Lightbox Modal for Image Gallery -->
  <div id="lightbox-modal" class="lightbox-modal">
    <span class="lightbox-close" onclick="event.stopPropagation(); EmberCore.closeLightbox()">
      <i class='bx bx-x'></i>
    </span>
    <img id="lightbox-img" class="lightbox-content" src="" alt="">
    <p id="lightbox-caption" class="lightbox-caption"></p>
  </div>

  <!-- Report Modal -->
  <div id="report-modal" class="report-modal">
    <div class="report-modal-content" onclick="event.stopPropagation()">
      <div class="report-modal-header">
        <h3>Report</h3>
        <button class="report-close-btn" onclick="event.stopPropagation(); EmberCore.closeReportModal()">
          <i class='bx bx-x'></i>
        </button>
      </div>
      <div class="report-modal-body">
        <div class="report-options">
          <div class="report-column">
            <label class="report-option">
              <input type="radio" name="report-reason" value="threats">
              <span>Threats & Harassment</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="false">
              <span>False Statements</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="nsfw">
              <span>NSFW</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="exploitation">
              <span>Child Exploitation</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="terrorism">
              <span>Terrorism & Extremism</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="drugs">
              <span>Drug Transactions</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="impersonation">
              <span>Impersonation</span>
            </label>
          </div>
          <div class="report-column">
            <label class="report-option">
              <input type="radio" name="report-reason" value="violence">
              <span>Excessive Violence</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="hate">
              <span>Hate Speech</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="harassment">
              <span>Sexual Harassment</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="self-harm">
              <span>Self Harm</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="illegal">
              <span>Illegal Activities</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="privacy">
              <span>Invading Privacy</span>
            </label>
            <label class="report-option">
              <input type="radio" name="report-reason" value="spam">
              <span>Commercial Spam</span>
            </label>
          </div>
        </div>
        <div class="report-details">
          <label>Additional details</label>
          <textarea id="report-details-input" placeholder="Describe the issue in further detail"></textarea>
        </div>
      </div>
      <div class="report-modal-footer">
        <button class="report-cancel-btn"
          onclick="event.stopPropagation(); EmberCore.closeReportModal()">Cancel</button>
        <button class="report-submit-btn" onclick="event.stopPropagation(); EmberCore.submitReport()">Submit</button>
      </div>
    </div>
  </div>




  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>



  <!-- Authentication script already loaded in head -->

  <!-- Application Scripts (depend on auth) -->
  <script src="js/products.js" defer></script>
  <script src="js/search.js" defer></script>
  <script src="js/search-integration.js" defer></script>
  <script src="js/cart.js" defer></script>
  <script src="js/navigation.js" defer></script>
  <script src="js/dollar-font.js" defer></script>
  <script src="js/app.js" defer></script>
  <script src="js/cookie-manager.js" defer></script>

  <!-- Navigation Dropdown & Mobile Menu Functionality -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Dropdown toggle functionality for Categories and Brands
      const dropdownItems = document.querySelectorAll('.mobile-dropdown-item');
      dropdownItems.forEach(item => {
        const toggleBtn = item.querySelector('.split-button.single-toggle-action');
        const dropdown = item.querySelector('.mobile-dropdown');

        if (toggleBtn && dropdown) {
          toggleBtn.addEventListener('click', (e) => {
            e.stopPropagation();

            // Close other dropdowns
            dropdownItems.forEach(otherItem => {
              if (otherItem !== item) {
                otherItem.classList.remove('active');
              }
            });

            // Toggle current dropdown
            item.classList.toggle('active');
          });
        }
      });

      // Close dropdowns when clicking outside
      document.addEventListener('click', (e) => {
        dropdownItems.forEach(item => {
          if (!item.contains(e.target)) {
            item.classList.remove('active');
          }
        });
      });

      // Mobile Menu Toggle (Hamburger)
      const hamburger = document.getElementById('hamburger');
      const mobileMenu = document.getElementById('mobileMenu');
      const closeBtn = document.getElementById('closeBtn');

      if (hamburger && mobileMenu) {
        hamburger.addEventListener('click', () => {
          mobileMenu.classList.add('active');
        });
      }

      if (closeBtn && mobileMenu) {
        closeBtn.addEventListener('click', () => {
          mobileMenu.classList.remove('active');
        });
      }

      // Close on Outside Click
      document.addEventListener('click', (e) => {
        if (mobileMenu && mobileMenu.classList.contains('active')) {
          if (!mobileMenu.contains(e.target) && !hamburger.contains(e.target)) {
            mobileMenu.classList.remove('active');
          }
        }
      });
    });

    // Collapsible Sidebar Functionality - Moved to prevent conflicts
    let sidebarCollapsibles = document.querySelectorAll('.sidebar-collapsible');
    sidebarCollapsibles.forEach(col => {
      const btn = col.querySelector('.collapsible-trigger');
      const content = col.querySelector('.collapsible-content');

      btn.addEventListener('click', () => {
        // Close all other collapsibles first
        sidebarCollapsibles.forEach(otherCol => {
          if (otherCol !== col) {
            otherCol.classList.remove('open');
            const otherContent = otherCol.querySelector('.collapsible-content');
            if (otherContent) {
              otherContent.style.maxHeight = '0';
            }
          }
        });

        // Toggle current collapsible
        const isOpen = col.classList.contains('open');
        col.classList.toggle('open');

        if (col.classList.contains('open')) {
          // Calculate and set dynamic height
          content.style.maxHeight = content.scrollHeight + 'px';
        } else {
          content.style.maxHeight = '0';
        }
      });
    });

    // Function to toggle user icon visibility
    function toggleUserIcon(show) {
      const icon = document.getElementById('Hide/UnhideUserIcon');
      if (icon) {
        icon.style.display = show ? 'flex' : 'none';
      }
    }

    // Function to toggle signup button visibility
    function toggleSignupBtn(show) {
      const btn = document.getElementById('Hide/UnhideSignupBtn');
      if (btn) {
        btn.style.display = show ? 'flex' : 'none';
      }
    }

    // Auth & Dropdown Logic
    const initAuthUI = async () => {
      if (!window.DB) return;

      const { data: { user } } = await DB.getUser();

      // Toggle user icon based on login status
      toggleUserIcon(!!user);
      toggleSignupBtn(!user);

      if (user) {
        // Declare profile elements early so they can be used throughout
        const profileIconBtn = document.getElementById('profileIconBtn');
        const profileDropdownContainer = document.getElementById('profileDropdownContainer');
        const loginLink = document.querySelector('a[href="login.html"]');

        if (loginLink && loginLink.parentElement) {
          const li = loginLink.parentElement;
          const name = user.user_metadata.full_name || 'User';
          const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=0099ff&color=fff`;

          // Show Profile Icon and Hide Login Link
          const signupBtn = document.getElementById('signupNavBtn');

          if (profileIconBtn) profileIconBtn.style.display = 'flex';
          if (profileDropdownContainer) profileDropdownContainer.style.display = 'block';
          if (signupBtn) signupBtn.style.display = 'none';

          // Hide the login link
          li.style.display = 'none';

          // Update profile dropdown header with user information
          const profileDropdownName = document.getElementById('profileDropdownName');
          const profileDropdownEmail = document.getElementById('profileDropdownEmail');
          const dropdownHeaderImg = document.getElementById('dropdownHeaderImg');
          const profileIconImg = document.getElementById('profileIconImg');

          if (profileDropdownName) {
            profileDropdownName.textContent = name;
          }

          if (profileDropdownEmail && user.email) {
            profileDropdownEmail.textContent = user.email;
          }

          // Update profile images with user avatar or generated avatar
          if (dropdownHeaderImg) {
            const storedAvatar = localStorage.getItem('be_avatar_' + user.id);
            if (storedAvatar) {
              dropdownHeaderImg.src = storedAvatar;
            } else {
              dropdownHeaderImg.src = avatarUrl;
            }
          }

          if (profileIconImg) {
            const storedAvatar = localStorage.getItem('be_avatar_' + user.id);
            if (storedAvatar) {
              profileIconImg.src = storedAvatar;
            } else {
              profileIconImg.src = avatarUrl;
            }
          }

          // Load Custom Profile Picture if exists
          const storedAvatar = localStorage.getItem('be_avatar_' + user.id);
          if (storedAvatar) {
            const avatarImg = li.querySelector('#navbar-avatar-img');
            if (avatarImg) avatarImg.src = storedAvatar;
          }

          // Logout Handler
          const navLogoutBtn = document.getElementById('nav-dropdown-logout');
          if (navLogoutBtn) {
            navLogoutBtn.addEventListener('click', async (e) => {
              e.preventDefault();

              // Create the actual logout function
              const performLogout = async () => {
                await DB.signOut();
                window.location.reload();
              };

              // Use custom modal if available
              if (window.showLogoutConfirmation && typeof window.showLogoutConfirmation === 'function') {
                window.showLogoutConfirmation(performLogout);
              } else {
                // Fallback to native confirm
                if (confirm('Are you sure you want to logout?')) {
                  await performLogout();
                }
              }
            });
          }

          // Profile dropdown functionality is handled by external profile-dropdown.js script
          // No need for duplicate event handlers here
        }

        // Mobile Sidebar Injection
        const sidebarHeader = document.querySelector('.sidebar-header');
        const sidebarFooter = document.querySelector('.sidebar-footer');
        const sidebarLoginLink = document.getElementById('sidebar-login-link');

        if (sidebarHeader && sidebarFooter) {
          // Update Header with User Info
          const name = user.user_metadata.full_name || 'User';
          const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=0099ff&color=fff`;

          // Replace the "default-brand" part with User Profile
          const brandContainer = sidebarHeader.querySelector('.header-brand');
          if (brandContainer) {
            brandContainer.innerHTML = `
                <img src="${avatarUrl}" class="sidebar-avatar" alt="Profile" id="mobile-avatar-img">
                <div class="user-info">
                    <span class="user-name">Hello, ${name}</span>
                    <span class="user-status">Member</span>
                </div>
              `;
          }

          // Hide "Login" Wrapper
          const loginWrapper = document.getElementById('sidebar-login-container');
          if (loginWrapper) loginWrapper.style.display = 'none';

          // Sync Custom Avatar
          const storedAvatar = localStorage.getItem('be_avatar_' + user.id);
          if (storedAvatar) {
            const mAvatar = sidebarHeader.querySelector('#mobile-avatar-img');
            if (mAvatar) mAvatar.src = storedAvatar;
          }
        }
      }
    };

    // Run Immediately or Wait
    if (window.DB) {
      initAuthUI();
    } else {
      document.addEventListener('dbReady', initAuthUI);
    }

    // Dark Mode Toggle Functionality
    document.addEventListener('DOMContentLoaded', function () {
      const mobileThemeToggle = document.getElementById('mobile-theme-toggle');
      const desktopThemeToggle = document.getElementById('desktop-theme-toggle');

      // Function to toggle dark mode
      function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');

        // Save preference to localStorage
        const isDarkMode = document.body.classList.contains('dark-mode');
        localStorage.setItem('darkMode', isDarkMode);

        // Update both toggle icons
        const mobileIcon = mobileThemeToggle?.querySelector('i');
        const desktopIcon = desktopThemeToggle?.querySelector('i');

        if (isDarkMode) {
          if (mobileIcon) mobileIcon.className = 'fa-solid fa-sun';
          if (desktopIcon) desktopIcon.className = 'fa-solid fa-sun';
        } else {
          if (mobileIcon) mobileIcon.className = 'fa-solid fa-moon';
          if (desktopIcon) desktopIcon.className = 'fa-solid fa-moon';
        }
      }

      // Mobile theme toggle
      if (mobileThemeToggle) {
        mobileThemeToggle.addEventListener('click', toggleDarkMode);
      }

      // Desktop theme toggle
      if (desktopThemeToggle) {
        desktopThemeToggle.addEventListener('click', toggleDarkMode);
      }

      // Load saved theme preference
      const savedDarkMode = localStorage.getItem('darkMode') === 'true';
      if (savedDarkMode) {
        document.body.classList.add('dark-mode');
        const mobileIcon = mobileThemeToggle?.querySelector('i');
        const desktopIcon = desktopThemeToggle?.querySelector('i');
        if (mobileIcon) mobileIcon.className = 'fa-solid fa-sun';
        if (desktopIcon) desktopIcon.className = 'fa-solid fa-sun';
      }
    });

    // Logout Modal Functionality
    function showLogoutModal() {
      const modal = document.getElementById('logout-modal');
      if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
      }
    }

    function hideLogoutModal() {
      const modal = document.getElementById('logout-modal');
      if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = '';
      }
    }

    // Initialize logout modal event listeners
    const modal = document.getElementById('logout-modal');
    const closeBtn = document.getElementById('logout-modal-close');
    const cancelBtn = document.getElementById('logout-cancel-btn');
    const confirmBtn = document.getElementById('logout-confirm-btn');
    const overlay = modal?.querySelector('.logout-modal-overlay');

    // Close modal events
    if (closeBtn) closeBtn.addEventListener('click', hideLogoutModal);
    if (cancelBtn) cancelBtn.addEventListener('click', hideLogoutModal);
    if (overlay) overlay.addEventListener('click', hideLogoutModal);

    // Confirm logout
    if (confirmBtn) {
      confirmBtn.addEventListener('click', async () => {
        hideLogoutModal();
        try {
          await DB.signOut();
          window.location.reload();
        } catch (error) {
          console.error('Logout error:', error);
          alert('Error during logout. Please try again.');
        }
      });
    }

    // ESC key to close modal
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape' && modal && modal.style.display === 'flex') {
        hideLogoutModal();
      }
    });

    // Make showLogoutModal available globally for other scripts
    window.showLogoutConfirmation = showLogoutModal;
  </script>

</body>
<!-- Lenis Smooth Scroll -->
  <script src="https://unpkg.com/lenis@1.1.20/dist/lenis.min.js"></script>
  <!-- Scroll Reveal & Lenis Init -->
  <script src="js/scroll-reveal.js"></script>
</html>